---
title: 虚拟机磁盘挂载
tags: 
- Linux
---
### 磁盘挂载

记录一下在 centos 将一个新的磁盘进行分区、格式化并挂载到一个新目录，需要执行的操作。

#### 小于2T磁盘挂载

1. **查看新磁盘信息**

   使用 `lsblk` 命令确认新磁盘的设备名（假设为 `/dev/sdc`）。

   ```bash
   lsblk
   ```

   <!--more-->

2. **创建分区**

   使用 `fdisk` 或 `parted` 命令为新磁盘创建分区。这里以 `fdisk` 为例：

   ```bash
   sudo fdisk /dev/sdc
   ```

   按照提示创建一个新分区，通常是以下步骤：

   - 输入 `n` 创建新分区。
   - 选择分区类型（ `p` 为主分区， `e` 为拓展分区）。
   - 选择分区号。
   - 输入分区起始点和结束点（直接回车使用默认值，即使用整个磁盘）。
   - 输入 `w` 写入分区表并退出。

3. **创建文件系统**

   使用 `mkfs` 命令在新的分区上创建 `xfs` 文件系统。如果在步骤2创建的是 `/dev/sdc1` 分区，则命令如下：

   ```bash
   sudo mkfs.xfs /dev/sdc1
   ```

4. **创建挂载点**

   创建一个新目录作为挂载点，例如 `/mnt/newdisk` ：

   ```bash
   sudo mkdir /mnt/newdisk
   ```

5. **挂载分区**

   将新分区挂载到刚才创建的目录：

   ```bash
   sudo mount /dev/sdc1 /mnt/newdisk
   ```

6. **设置开机自启动**

   为了在系统启动时自动挂载新分区，需要编辑 `/etc/fstab` 文件：

   ```bash
   sudo nano /etc/fstab
   ```

   在文件末尾添加一行，即：

   ```
   /dev/sdc1    /mnt/newdisk    xfs    defaults    0    0
   ```

   保存并关闭文件。

7. **测试 `fstab` 配置**

   执行命令测试 `fatab` 的配置是否正确：

   ```bash
   sudo mount -a
   ```

   没有报错只说明配置正确。

8. **检查挂载**

   使用 `df -h` 或 `mount` 命令检查寻分区是否已经被正确挂载：

   ```bash
   df -h
   ```

   或者

   ```bash
   mount | grep /mnt/newdisk
   ```



#### 大于2T磁盘挂载

步骤跟 `fdisk` 命令差不多，但使用的是 `gdisk` 命令。 `gdisk` 是 `fdisk` 的GPT版本。，可以通过包管理器进行安装。

1. **启动 `gdisk`** 

   ```bash
   sudo gdisk /dev/sdc
   ```

2. **创建新的GPT分区表**

   - 输入 `o` 创建一个新的空的GUID分区表。
   - 输入 `y` 确认。

3. **创建新的分区**

   - 输入 `n` 添加一个新分区。
   - 输入分区号（直接回车选择默认值）。
   - 输入分区的起始扇区（直接回车选择默认值）。
   - 输入分区的结束扇区或者大小（例如 `+2T` 或直接回车使用整个磁盘）。
   - 输入分区类型代码（直接回车选择默认的Linux文件系统类型）。

4. **写入分区表并退出**

   - 输入 `w` 写入分区表到磁盘。
   - 输入 `y` 确认。

5. **创建文件系统**

   创建 `xfs` 文件系统：

   ```bash
   sudo mkfs.xfs /dev/sdc1
   ```

后续的挂载检查同之前的步骤了。